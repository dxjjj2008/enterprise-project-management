# 计划管理页面详细设计方案

**版本**: v1.0  
**创建日期**: 2026-02-10  
**优先级**: P0  
**复杂度**: 高  
**预计页数**: 2

---

## 1. 页面概述

### 1.1 页面定位

计划管理页面是企业项目管理系统中进行项目计划和进度管理的核心页面，支持计划的创建、编辑、分解（WBS）、进度跟踪和基线对比等功能。

### 1.2 目标用户

- 项目经理：创建和维护项目计划
- 团队成员：查看任务分配和进度
- 管理层：监控项目整体进度

### 1.3 核心功能

- 计划列表管理
- 计划创建/编辑
- WBS（工作分解结构）编辑
- 任务分配和依赖设置
- 进度跟踪和更新
- 基线对比分析

---

## 2. 页面结构

### 2.1 页面1：计划列表页

```
┌─────────────────────────────────────────────────────────────────────┐
│  页面标题栏                                                          │
│  [ 计划管理 ]                                           [新建计划]  │
├─────────────────────────────────────────────────────────────────────┤
│  筛选区域                                                            │
│  [项目▼] [状态▼] [时间范围▼] [关键词🔍]              [重置] [查询] │
├─────────────────────────────────────────────────────────────────────┤
│  计划卡片/列表视图                                                    │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  [视图切换] [卡片视图] [表格视图]                            │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │  计划卡片/列表数据展示区域                                   │   │
│  └─────────────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────────┤
│  分页组件                                                            │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 页面2：计划详情页（包含WBS编辑）

```
┌─────────────────────────────────────────────────────────────────────┐
│  面包屑导航                                                          │
│  [计划管理] > [项目A] > [项目计划]                                   │
├─────────────────────────────────────────────────────────────────────┤
│  页面工具栏                                                          │
│  [返回] [编辑] [保存] [发布] [设置里程碑] [导出] [更多▼]              │
├─────────────────────────────────────────────────────────────────────┤
│  计划概览区域                                                        │
│  ┌──────────────────────┐ ┌──────────────────────┐                │
│  │ 计划名称：项目A计划   │ │ 项目：项目A          │                │
│  │ 状态：进行中         │ │ 进度：65%            │                │
│  │ 开始日期：2026-01-01  │ │ 结束日期：2026-03-31 │                │
│  └──────────────────────┘ └──────────────────────┘                │
├─────────────────────────────────────────────────────────────────────┤
│  WBS编辑区域                                                          │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  [工具栏]: [添加任务] [添加子任务] [升级] [降级] [上移] [下移] │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │  [WBS树形表格区域]                                           │   │
│  │  层级展示任务结构，支持拖拽排序和缩进调整                     │   │
│  └─────────────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────────┤
│  底部状态栏                                                          │
│  [任务数：25] [已完成：16] [进行中：5] [未开始：4]                   │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 计划列表页设计

### 3.1 筛选条件

| 筛选项 | 控件类型 | 默认值 | 选项 |
|--------|----------|--------|------|
| 项目选择 | 下拉选择框 | 全部 | 所有项目列表 |
| 计划状态 | 下拉选择框 | 全部 | 草稿、进行中、已完成、已暂停、已归档 |
| 时间范围 | 日期范围选择器 | 最近30天 | 最近7天、最近30天、本月、上月、自定义 |
| 关键词搜索 | 文本输入框 | 空 | 支持计划名称、项目名称搜索 |

### 3.2 卡片视图设计

#### 3.2.1 卡片布局

```
┌─────────────────────────────────────┐
│  [状态标签]                         │
│  项目A - 项目计划                   │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━     │
│  进度条：[██████████░░░░░░] 65%    │
│                                     │
│  📅 2026-01-01 ~ 2026-03-31        │
│  👥 5人  📋 25任务  ✅ 16已完成     │
│                                     │
│  👤 张三  🕐 更新于2小时前         │
└─────────────────────────────────────┘
```

#### 3.2.2 卡片信息字段

| 字段 | 图标 | 说明 |
|------|------|------|
| 计划名称 | - | 计划标题 |
| 项目名称 | 📁 | 关联项目 |
| 进度 | 📊 | 进度百分比和进度条 |
| 时间范围 | 📅 | 开始日期和结束日期 |
| 任务统计 | 📋 | 总任务数、已完成数 |
| 负责人 | 👤 | 计划负责人 |
| 更新时间 | 🕐 | 最后更新时间 |

### 3.3 表格视图设计

| 列名称 | 列宽度 | 数据来源 | 对齐方式 |
|--------|--------|----------|----------|
| 计划名称 | 250px | 计划标题 | 居左 |
| 关联项目 | 150px | 项目名称 | 居左 |
| 负责人 | 100px | 负责人姓名+头像 | 居左 |
| 进度 | 180px | 进度百分比+进度条 | 居左 |
| 开始日期 | 120px | 开始日期 | 居左 |
| 结束日期 | 120px | 结束日期 | 居左 |
| 状态 | 100px | 计划状态 | 居左 |
| 更新时间 | 160px | 更新时间 | 居左 |
| 操作 | 150px | 操作按钮组 | 居右 |

---

## 4. 计划详情页设计

### 4.1 计划概览区域

#### 4.1.1 基本信息卡片

| 字段 | 显示值 | 可编辑 |
|------|--------|--------|
| 计划名称 | 项目A主计划 | 是 |
| 关联项目 | 项目A | 否 |
| 计划状态 | 进行中 | 是 |
| 计划进度 | 65% | 自动计算 |
| 开始日期 | 2026-01-01 | 是 |
| 结束日期 | 2026-03-31 | 是 |
| 计划描述 | 计划描述内容... | 是 |

#### 4.1.2 进度统计卡片

| 统计项 | 数值 | 占比 |
|--------|------|------|
| 总任务数 | 25 | 100% |
| 已完成任务 | 16 | 64% |
| 进行中任务 | 5 | 20% |
| 未开始任务 | 4 | 16% |
| 逾期任务 | 2 | 8% |

### 4.2 WBS编辑区域

#### 4.2.1 WBS工具栏

| 按钮 | 图标 | 功能说明 | 快捷键 |
|------|------|----------|--------|
| 添加任务 | ➕ | 在当前层级添加同级任务 | Ctrl+N |
| 添加子任务 | ➕↘️ | 添加当前任务的子任务 | Ctrl+Shift+N |
| 升级 | ↖️ | 将选中任务提升一个层级 | Ctrl+← |
| 降级 | ↗️ | 将选中任务降低一个层级 | Ctrl+→ |
| 上移 | ⬆️ | 将选中任务向上移动 | Ctrl+↑ |
| 下移 | ⬇️ | 将选中任务向下移动 | Ctrl+↓ |
| 复制 | 📋 | 复制选中任务 | Ctrl+C |
| 粘贴 | 📋 | 粘贴复制的任务 | Ctrl+V |
| 删除 | 🗑️ | 删除选中任务 | Delete |

#### 4.2.2 WBS树形表格结构

| 列名称 | 列宽度 | 可编辑 | 说明 |
|--------|--------|--------|------|
| 展开/折叠 | 40px | 否 | 控制子任务显示 |
| 序号 | 60px | 否 | 自动生成序号 |
| 任务名称 | 300px | 是 | 任务标题 |
| 负责人 | 120px | 是 | 下拉选择成员 |
| 开始日期 | 120px | 是 | 日期选择器 |
| 结束日期 | 120px | 是 | 日期选择器 |
| 工期 | 80px | 是 | 数字输入（天） |
| 进度 | 150px | 是 | 滑动条 0-100% |
| 依赖 | 100px | 是 | 选择前置任务 |
| 里程碑 | 60px | 是 | 复选框 |
| 操作 | 100px | 否 | 操作按钮组 |

#### 4.2.3 WBS树形表格交互

- **层级缩进**：通过缩进量展示任务层级关系
- **拖拽排序**：支持拖拽调整任务顺序
- **拖拽缩进**：拖拽到其他任务下方自动调整层级
- **自动序号**：根据层级和顺序自动生成序号
- **依赖连线**：前置任务和后继任务之间显示连线
- **工期计算**：自动计算基于依赖的任务时间

### 4.3 里程碑管理

#### 4.3.1 里程碑列表

| 里程碑名称 | 关联任务 | 计划日期 | 状态 |
|------------|----------|----------|------|
| 项目启动 | 任务1 | 2026-01-01 | 已完成 |
| 需求确认 | 任务5 | 2026-01-15 | 已完成 |
| 设计完成 | 任务12 | 2026-02-15 | 进行中 |
| 开发完成 | 任务20 | 2026-03-15 | 未开始 |
| 项目上线 | 任务25 | 2026-03-31 | 未开始 |

#### 4.3.2 里程碑标记

- 在WBS表格中用特殊图标标记里程碑任务
- 在甘特图中用菱形节点显示里程碑
- 里程碑进度独立计算

---

## 5. 交互设计

### 5.1 列表页交互

1. **进入页面**：显示加载状态，获取计划列表数据
2. **切换视图**：点击卡片/表格视图切换按钮，切换展示方式
3. **筛选查询**：选择筛选条件后自动或点击查询刷新列表
4. **点击计划卡片**：跳转到计划详情页
5. **点击新建计划**：弹出新建计划对话框

### 5.2 详情页交互

1. **进入详情页**：加载计划基本信息和WBS数据
2. **编辑模式**：点击编辑按钮进入编辑模式
3. **WBS编辑**：
   - 选中任务后可以使用工具栏按钮进行操作
   - 右键菜单提供快捷操作
   - 拖拽调整任务顺序和层级
4. **保存更改**：点击保存按钮保存所有更改
5. **发布计划**：确认计划内容后发布计划

### 5.3 进度更新交互

1. **打开进度更新**：在任务行上点击进度单元格
2. **调整进度**：拖动滑动条调整进度值
3. **确认更新**：进度值变化后自动保存或手动确认

---

## 6. 数据接口设计

### 6.1 API接口列表

|方式 | 路径 | 说明 |
| 接口名称 | 请求----------|----------|------|------|
| 获取计划列表 | GET | /api/v1/plans | 支持分页和筛选 |
| 获取计划详情 | GET | /api/v1/plans/{id} | 获取单个计划详情 |
| 创建计划 | POST | /api/v1/plans | 创建新计划 |
| 更新计划 | PUT | /api/v1/plans/{id} | 更新计划基本信息 |
| 删除计划 | DELETE | /api/v1/plans/{id} | 删除计划 |
| 获取WBS数据 | GET | /api/v1/plans/{id}/wbs | 获取WBS任务树 |
| 更新WBS任务 | PUT | /api/v1/plans/{id}/wbs/{task_id} | 更新单个任务 |
| 批量更新WBS | PUT | /api/v1/plans/{id}/wbs/batch | 批量更新任务 |
| 添加任务 | POST | /api/v1/plans/{id}/wbs | 添加新任务 |
| 删除任务 | DELETE | /api/v1/plans/{id}/wbs/{task_id} | 删除任务 |
| 获取里程碑 | GET | /api/v1/plans/{id}/milestones | 获取里程碑列表 |
| 添加里程碑 | POST | /api/v1/plans/{id}/milestones | 添加里程碑 |
| 更新里程碑 | PUT | /api/v1/plans/{id}/milestones/{mid} | 更新里程碑 |
| 删除里程碑 | DELETE | /api/v1/plans/{id}/milestones/{mid} | 删除里程碑 |
| 导出计划 | GET | /api/v1/plans/{id}/export | 导出计划数据 |
| 保存基线 | POST | /api/v1/plans/{id}/baselines | 保存计划基线 |

### 6.2 数据字段说明

#### 计划基本信息字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | number | 计划ID |
| name | string | 计划名称 |
| project_id | number | 关联项目ID |
| project_name | string | 关联项目名称 |
| status | string | 计划状态 |
| progress | number | 计划进度 0-100 |
| start_date | date | 开始日期 |
| end_date | date | 结束日期 |
| description | string | 计划描述 |
| owner_id | number | 负责人ID |
| owner_name | string | 负责人姓名 |
| created_at | datetime | 创建时间 |
| updated_at | datetime | 更新时间 |

#### WBS任务字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | number | 任务ID |
| plan_id | number | 关联计划ID |
| parent_id | number | 父任务ID |
| name | string | 任务名称 |
| level | number | 任务层级 |
| sort_order | number | 排序序号 |
| assignee_id | number | 执行人ID |
| assignee_name | string | 执行人姓名 |
| start_date | date | 开始日期 |
| end_date | date | 结束日期 |
| duration | number | 工期（天） |
| progress | number | 进度 0-100 |
| dependency | array | 前置任务ID列表 |
| is_milestone | boolean | 是否里程碑 |
| status | string | 任务状态 |

---

## 7. 组件设计

### 7.1 组件结构

```
PlanningList.vue (计划列表页)
├── PageHeader
├── FilterSection
├── PlanningViewToggle (视图切换)
├── PlanningCardList (卡片列表)
│   └── PlanningCard
├── PlanningTable (表格列表)
│   ├── TableColumn
│   └── OperationButtons
└── Pagination

PlanningDetail.vue (计划详情页)
├── BreadcrumbNav (面包屑导航)
├── PageToolbar (工具栏)
├── PlanOverview (计划概览)
│   ├── BasicInfoCard
│   └── ProgressStatsCard
├── WBSEditor (WBS编辑器)
│   ├── WBSToolbar (工具栏)
│   ├── WBSTreeTable (树形表格)
│   │   ├── WBSRow (表格行)
│   │   └── WBSCellEditor (单元格编辑器)
│   └── WBSTaskEditor (任务编辑器弹窗)
├── MilestoneManager (里程碑管理)
│   └── MilestoneTimeline
└── StatusBar (底部状态栏)
```

### 7.2 核心组件说明

#### WBSTreeTable 组件

- **功能**：展示和编辑WBS任务树
- **特性**：
  - 树形结构展示
  - 拖拽排序和缩进
  - 多选操作
  - 虚拟滚动（大数据量优化）
- **事件**：
  - `task-click`：点击任务事件
  - `task-change`：任务变更事件
  - `task-reorder`：任务顺序变更事件

#### WBSToolbar 组件

- **功能**：提供WBS编辑工具栏
- **属性**：
  - `selectedTaskId`：当前选中的任务ID
  - `canUpgrade`：是否可以升级
  - `canDowngrade`：是否可以降级
- **事件**：
  - `add-task`：添加任务事件
  - `upgrade`：升级事件
  - `downgrade`：降级事件

---

## 8. 样式设计

### 8.1 页面整体样式

```scss
.planning-page {
  max-width: 1440px;
  margin: 0 auto;
  padding: 24px;
  
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
  }
  
  .filter-section {
    display: flex;
    gap: 16px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  
  .planning-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
    gap: 24px;
  }
  
  .planning-table {
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
  }
}

.planning-detail-page {
  padding: 24px;
  
  .breadcrumb-nav {
    margin-bottom: 16px;
  }
  
  .page-toolbar {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
    padding: 16px;
    background: #fff;
    border-radius: 8px;
  }
  
  .plan-overview {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
    margin-bottom: 24px;
  }
  
  .wbs-editor {
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
  }
  
  .wbs-toolbar {
    display: flex;
    gap: 8px;
    padding: 12px 16px;
    border-bottom: 1px solid #E8E8E8;
  }
  
  .wbs-tree-table {
    min-height: 400px;
  }
}
```

### 8.2 层级缩进样式

```scss
.wbs-row {
  .level-indicator {
    width: 24px * (level - 1);
    border-left: 2px solid #E8E8E8;
    margin-left: 12px;
  }
  
  &.is-leaf {
    .level-indicator {
      border-left: none;
    }
  }
}
```

### 8.3 里程碑样式

```scss
.milestone-marker {
  width: 16px;
  height: 16px;
  transform: rotate(45deg);
  background: #FAAD14;
  border: 2px solid #D48806;
  
  &.completed {
    background: #52C41A;
    border-color: #389E0D;
  }
}
```

---

## 9. 无障碍性设计

### 9.1 键盘导航

| 快捷键 | 功能 |
|--------|------|
| Ctrl+N | 添加同级任务 |
| Ctrl+Shift+N | 添加子任务 |
| Ctrl+← | 升级任务 |
| Ctrl+→ | 降级任务 |
| Ctrl+↑ | 上移任务 |
| Ctrl+↓ | 下移任务 |
| Delete | 删除选中任务 |
| Enter | 编辑选中任务 |

### 9.2 ARIA属性

```vue
<!-- WBS表格 -->
<div role="treegrid" aria-label="WBS任务列表">
  <div role="row" aria-level="1">
    <div role="gridcell">任务1</div>
    ...
  </div>
</div>

<!-- 进度滑动条 -->
<div role="slider"
     aria-valuenow="65"
     aria-valuemin="0"
     aria-valuemax="100"
     aria-label="任务进度">
</div>
```

---

## 10. 测试用例

### 10.1 功能测试

| 测试场景 | 预期结果 |
|----------|----------|
| 进入计划列表页面 | 正确显示计划和筛选区域 |
| 切换卡片/表格视图 | 正确切换展示方式 |
| 使用筛选功能 | 列表显示符合筛选条件的数据 |
| 点击新建计划按钮 | 弹出新建计划对话框 |
| 创建新计划 | 计划创建成功并跳转到详情页 |
| 进入计划详情页 | 正确显示计划基本信息和WBS |
| 添加同级任务 | 任务添加到当前层级 |
| 添加子任务 | 任务作为子任务添加 |
| 使用升级/降级功能 | 任务层级正确调整 |
| 拖拽调整顺序 | 任务顺序正确调整 |
| 编辑任务信息 | 任务信息正确更新 |
| 设置里程碑 | 里程碑正确添加并标记 |
| 保存并发布计划 | 计划状态更新为进行中 |

### 10.2 边界测试

| 测试场景 | 预期结果 |
|----------|----------|
| 大量任务（100+）时性能 | 页面流畅，无明显卡顿 |
| 深层级嵌套（5+层） | 层级展示正确，缩进正常 |
| 循环依赖设置 | 前端校验并阻止保存 |

---

## 11. 验收标准

### 11.1 功能验收

- [ ] 计划列表正确显示
- [ ] 筛选和搜索功能正常
- [ ] 视图切换功能正常
- [ ] 计划创建和编辑正常
- [ ] WBS编辑功能完整
- [ ] 拖拽排序和层级调整正常
- [ ] 里程碑管理正常
- [ ] 进度更新正常

### 11.2 交互验收

- [ ] 加载状态清晰
- [ ] 操作反馈及时
- [ ] 动画过渡自然
- [ ] 错误提示友好

### 11.3 无障碍验收

- [ ] 键盘导航完整
- [ ] ARIA属性正确
- [ ] 颜色对比度达标

---

## 12. 开发计划

### 12.1 开发顺序

1. 计划列表页基础布局
2. 卡片视图和表格视图
3. 筛选功能
4. 计划详情页框架
5. 计划概览区域
6. WBS编辑器基础功能
7. WBS工具栏功能
8. 拖拽排序和层级调整
9. 里程碑管理
10. 进度跟踪
11. API联调
12. 测试优化

### 12.2 预计工时

| 任务 | 预计工时 |
|------|----------|
| 计划列表页 | 4小时 |
| 计划详情页框架 | 2小时 |
| 计划概览 | 2小时 |
| WBS编辑器基础 | 4小时 |
| WBS工具栏功能 | 3小时 |
| 拖拽和层级调整 | 4小时 |
| 里程碑管理 | 2小时 |
| 进度跟踪 | 2小时 |
| API联调 | 4小时 |
| 测试优化 | 3小时 |
| **总计** | **30小时** |

---

**文档版本**: v1.0  
**最后更新**: 2026-02-10

# WBS编辑页 - 设计文档

**版本**: v1.0
**创建日期**: 2026-02-10
**更新日期**: 2026-02-10
**状态**: 待实现

---

## 一、页面概述

### 1.1 页面定位

WBS编辑页提供详细的工作分解结构（Work Breakdown Structure）编辑功能，支持树形结构的添加、编辑、删除、排序等操作，是项目计划管理的核心页面。

### 1.2 用户角色

- **项目经理**: 完全权限，可创建、编辑、删除所有WBS节点
- **项目成员**: 查看权限，可创建和编辑自己的任务节点
- **只读用户**: 仅查看权限

### 1.3 页面路径

```
/projects/:id/wbs-edit
```

### 1.4 权限控制

| 功能 | 项目经理 | 项目成员 | 只读用户 |
|------|----------|----------|----------|
| 添加节点 | ✅ | ✅ | ❌ |
| 编辑节点 | ✅ | ✅ | ❌ |
| 删除节点 | ✅ | ⚠️ (仅自己的节点) | ❌ |
| 移动节点 | ✅ | ❌ | ❌ |
| 批量操作 | ✅ | ❌ | ❌ |

---

## 二、页面布局

### 2.1 整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│  [← 返回]  WBS 编辑                           [💾 保存] [✅ 完成] │
├─────────────────────────────────────────────────────────────────┤
│  项目名称: 企业项目管理系统                                       │
│  项目Key: PJ123456                                               │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ Tab 内容区                                                  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  面包屑: 首页 / 项目 / WBS 编辑                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 三、页面内容

### 3.1 左侧：WBS树视图

```
┌─────────────────────────────────────────────────┐
│  📋 WBS 树                                      │
│  ┌───────────────────────────────────────────┐  │
│  │ [+ 添加父节点]                             │  │
│  └───────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────┐  │
│  │ 📁 1.0 项目启动        [显示子节点]       │  │
│  │ ┌─────────────────────────────────────┐  │  │
│  │ │ [+ 添加子节点]                      │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  │ │ 📁 1.1 需求收集      [显示子节点]     │  │  │
│  │ │ └─────────────────────────────────┐  │  │  │
│  │ │   [+ 添加子节点]                   │  │  │  │
│  │ │ └─────────────────────────────────┘  │  │  │
│  │ │   ✅ 1.1.1 编写需求文档        [⋮]   │  │  │
│  │ │   ✅ 1.1.2 需求评审          [⋮]   │  │  │
│  │ │   ⏸️ 1.1.3 需求变更管理        [⋮]   │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  │ 📁 1.2 项目规划        [显示子节点]     │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  │ │ ✅ 1.2.1 制定项目计划          [⋮]   │  │  │
│  │ │ ✅ 1.2.2 分配任务                [⋮]   │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  │ 📁 2.0 系统设计          [显示子节点]     │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  │ │ 📁 2.1 架构设计          [显示子节点]  │  │  │
│  │ │ └─────────────────────────────────────┘  │  │
│  │ │   ✅ 2.1.1 系统架构设计          [⋮]   │  │  │
│  │ │   ✅ 2.1.2 数据库设计              [⋮]   │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  │ │ 📁 2.2 UI设计            [显示子节点]  │  │  │
│  │ │ └─────────────────────────────────────┘  │  │  │
│  │ │   ✅ 2.2.1 设计规范制定          [⋮]   │  │  │
│  │ │   ✅ 2.2.2 组件设计                [⋮]   │  │  │
│  │ └─────────────────────────────────────┘  │  │
│  └───────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

### 3.2 右侧：节点编辑表单

```
┌─────────────────────────────────────────────────┐
│  编辑节点信息 (当前选中: 1.1.1 编写需求文档)      │
├─────────────────────────────────────────────────┤
│                                                 │
│  节点名称                                     │
│  [编写需求文档_________________________]       │
│  (必填，最多100字符)                           │
│                                                 │
│  节点类型                                     │
│  [任务(Task) ▼]                               │
│  - 里程碑(Milestone)                           │
│  - 任务(Task)                                   │
│  - 阶段(Phase)                                  │
│  - 可交付成果(Deliverable)                      │
│                                                 │
│  负责人                                       │
│  [zhangsan ▼]                                 │
│  - zhangsan                                    │
│  - lisi                                        │
│  - wangwu                                      │
│                                                 │
│  截止日期                                     │
│  [📅 2026-01-18 __________________]            │
│  (可选，默认继承父节点日期)                     │
│                                                 │
│  优先级                                       │
│  [🔴 紧急 ▼]                                  │
│  - 🔴 紧急                                     │
│  - 🟠 高                                       │
│  - 🔵 中                                       │
│  - ⚪ 低                                       │
│                                                 │
│  估计工时 (小时)                               │
│  [8 ___________________________________]      │
│  (可选，用于计算进度)                           │
│                                                 │
│  状态                                         │
│  [✅ 待办 ▼]                                   │
│  - ✅ 待办                                     │
│  - 🔄 进行中                                   │
│  - ✅ 已完成                                   │
│  - ⏸️ 暂停                                     │
│                                                 │
│  描述                                         │
│  [_________________________________________   │
│   _________________________________________   │
│   _________________________________________   │
│   _________________________________________   │
│   _________________________________________]  │
│  (可选，最多1000字符)                           │
│                                                 │
│  子节点                                         │
│  ┌─────────────────────────────────────────┐  │
│  │ 无子节点                                 │  │
│  └─────────────────────────────────────────┘  │
│                                                 │
├─────────────────────────────────────────────────┤
│           [❌ 删除此节点]                         │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 四、节点类型说明

### 4.1 节点类型

| 类型 | 图标 | 说明 | 可创建子节点 |
|------|------|------|-------------|
| 里程碑 | 🏆 | 重要的时间点或检查点 | ❌ |
| 任务 | 📋 | 具体的工作项 | ✅ |
| 阶段 | 📅 | 项目的大阶段 | ✅ |
| 可交付成果 | 📦 | 交付给客户的产品 | ❌ |

### 4.2 默认行为

| 类型 | 默认状态 | 默认优先级 | 可移动 |
|------|----------|------------|--------|
| 里程碑 | 待办 | 中 | ❌ |
| 任务 | 待办 | 中 | ✅ |
| 阶段 | 进行中 | 高 | ✅ |
| 可交付成果 | 已完成 | - | ❌ |

---

## 五、操作栏

### 5.1 顶部操作栏

```
┌─────────────────────────────────────────────────┐
│  📋 WBS 编辑                           [💾 保存] [✅ 完成] │
├─────────────────────────────────────────────────┤
│                                                 │
│  层级缩放: [+] [─] [─] [─] [-] [+]              │
│                                                 │
│  视图模式: [树形视图] [并排视图]                │
│                                                 │
│  排序: [按名称排序] [按日期排序] [按优先级]    │
│                                                 │
│  操作: [▶ 播放计划] [⏸ 暂停计划] [🔄 重置]    │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
└─────────────────────────────────────────────────┘
```

### 5.2 WBS树操作按钮

| 按钮 | 说明 | 图标 |
|------|------|------|
| 显示子节点 | 展开当前节点的所有子节点 | 🔽 |
| 隐藏子节点 | 折叠当前节点的所有子节点 | 🔼 |
| 编辑节点 | 编辑当前节点信息 | ✏️ |
| 添加子节点 | 在当前节点下添加子节点 | ➕ |
| 添加兄弟节点 | 在同级添加节点 | ➕➕ |
| 上移 | 将节点向上移动一位 | ⬆️ |
| 下移 | 将节点向下移动一位 | ⬇️ |
| 删除节点 | 删除当前节点及其子节点 | 🗑️ |

### 5.3 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl + N | 添加新节点 |
| Enter | 保存当前节点 |
| Esc | 取消编辑 |
| → | 展开节点 |
| ← | 折叠节点 |
| ↑ | 上移节点 |
| ↓ | 下移节点 |
| Delete | 删除节点 |

---

## 六、批量操作

### 6.1 批量选择

```
┌─────────────────────────────────────────────────┐
│  📋 WBS 编辑                           [💾 保存] │
├─────────────────────────────────────────────────┤
│  ☑️ 全选                                         │
│                                                 │
│  📁 1.0 项目启动  ☑                             │
│  └─ ☑ 1.1 需求收集                              │
│  └─ ☑ 1.2 项目规划                              │
│  ┌─────────────────────────────────────────┐  │
│  │ ☑ 1.1.1 编写需求文档                     │  │
│  │ ☑ 1.1.2 需求评审                         │  │
│  │ ⏸️ 1.1.3 需求变更管理 (不可选)           │  │
│  └─────────────────────────────────────────┘  │
│  ┌─────────────────────────────────────────┐  │
│  │ 📁 2.0 系统设计  ☑                       │  │
│  │ └─ ☑ 2.1 架构设计                        │  │
│  └─ ☑ 2.2 UI设计                              │  │
└─────────────────────────────────────────────────┘
```

### 6.2 批量操作菜单

```
┌─────────────────────────────────────────────────┐
│  批量操作:                                        │
│                                                 │
│  [✏️ 批量编辑状态]                               │
│  [📅 批量设置日期]                               │
│  [👥 批量分配负责人]                             │
│  [📤 批量导出]                                  │
│  [🗑️ 批量删除]                                  │
│  [↑↓ 批量排序]                                  │
└─────────────────────────────────────────────────┘
```

---

## 七、快捷操作

### 7.1 新建节点

```
┌─────────────────────────────────────────────────┐
│  添加子节点                                     │
├─────────────────────────────────────────────────┤
│                                                 │
│  节点名称                                     │
│  [_________________________________]           │
│                                                 │
│  节点类型                                     │
│  [任务(Task) ▼]                               │
│                                                 │
│  负责人                                       │
│  [zhangsan ▼]                                 │
│                                                 │
│  截止日期                                     │
│  [📅 ____________]                             │
│                                                 │
│  [取消]  [添加]                                │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 7.2 编辑节点

见"右侧：节点编辑表单"章节

---

## 八、状态指示器

### 8.1 节点状态颜色

| 状态 | 颜色 | 图标 |
|------|------|------|
| 待办 | 灰色 | 📋 |
| 进行中 | 蓝色 | 🔄 |
| 已完成 | 绿色 | ✅ |
| 暂停 | 黄色 | ⏸️ |

### 8.2 优先级颜色

| 优先级 | 颜色 |
|--------|------|
| 紧急 | 红色 🔴 |
| 高 | 橙色 🟠 |
| 中 | 蓝色 🔵 |
| 低 | 灰色 ⚪ |

---

## 九、验证规则

### 9.1 必填字段

| 字段 | 规则 |
|------|------|
| 节点名称 | 2-100字符，必填 |
| 负责人 | 必选 |
| 节点类型 | 必选 |

### 9.2 数据验证

| 验证项 | 规则 | 错误提示 |
|--------|------|----------|
| 日期范围 | 结束日期 ≥ 开始日期 | 结束日期必须大于等于开始日期 |
| 负责人 | 必须选择 | 请选择负责人 |
| 节点名称 | 不能重复 | 节点名称已存在 |
| 子节点 | 不能无限嵌套 | 最大嵌套层级10层 |

---

## 十、API 接口

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/v1/projects/{id}/wbs | 获取WBS树 |
| POST | /api/v1/projects/{id}/wbs | 创建节点 |
| PUT | /api/v1/projects/{id}/wbs/{id} | 更新节点 |
| DELETE | /api/v1/projects/{id}/wbs/{id} | 删除节点 |
| POST | /api/v1/projects/{id}/wbs/{id}/children | 添加子节点 |
| PUT | /api/v1/projects/{id}/wbs/batch | 批量操作 |
| POST | /api/v1/projects/{id}/wbs/import | 导入WBS |
| GET | /api/v1/projects/{id}/wbs/export | 导出WBS |

---

## 十一、设计原则

### 11.1 简洁性

- 布局清晰，信息层次分明
- 不必要的操作隐藏在菜单中
- 支持快捷操作，提高效率

### 11.2 交互性

- 实时保存
- 拖拽排序
- 快捷键支持

### 11.3 可视化

- 状态和优先级用颜色区分
- 进度条显示
- 图标标识节点类型

### 11.4 灵活性

- 支持多种节点类型
- 支持自定义字段
- 支持导入导出

---

## 十二、注意事项

### 12.1 数据完整性

- 删除节点时自动删除子节点
- 保存时验证数据完整性
- 支持自动编号

### 12.2 性能优化

- 大树形结构使用虚拟滚动
- 懒加载子节点
- 操作防抖

### 12.3 权限控制

- 只能删除自己的节点（团队成员）
- 只能移动到有效层级
- 只能编辑有效节点

---

**文档结束**

**创建人**: 设计团队
**创建日期**: 2026-02-10
**版本**: v1.0

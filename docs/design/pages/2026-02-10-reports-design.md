# 报表统计页面详细设计方案

**版本**: v1.0  
**创建日期**: 2026-02-10  
**优先级**: P1  
**复杂度**: 高  
**预计页数**: 2

---

## 1. 页面概述

### 1.1 页面定位

报表统计页面是企业项目管理系统中进行数据分析和报表展示的核心页面，提供项目进度、资源使用、任务完成等多维度的数据统计和可视化分析功能。

### 1.2 目标用户

- 项目经理：查看项目整体状况和团队表现
- 部门经理：监控部门项目进度和资源分配
- 高层管理者：了解公司项目整体运营状况

### 1.3 核心功能

- 多维度数据统计
- 图表可视化展示
- 时间范围筛选
- 报表导出功能
- 数据钻取分析

---

## 2. 页面结构

### 2.1 页面1：统计概览页

```
┌─────────────────────────────────────────────────────────────────────┐
│  页面标题栏                                                          │
│  [ 报表统计 ]                                           [导出报表]  │
├─────────────────────────────────────────────────────────────────────┤
│  筛选控制栏                                                          │
│  [时间范围▼] [项目▼] [部门▼] [数据类型▼]              [应用] [重置] │
├─────────────────────────────────────────────────────────────────────┤
│  统计指标卡片区域                                                     │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐        │
│  │ 项目总数 │ │ 进行中  │ │ 已完成  │ │ 逾期数  │ │ 预算使用 │        │
│  │   25   │ │   12   │ │   10   │ │    3   │ │  78%   │        │
│  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘        │
├─────────────────────────────────────────────────────────────────────┤
│  图表展示区域                                                         │
│  ┌─────────────────────────┐ ┌─────────────────────────┐        │
│  │  项目进度分布饼图        │ │  任务完成趋势图          │        │
│  │                         │ │                         │        │
│  └─────────────────────────┘ └─────────────────────────┘        │
│  ┌─────────────────────────┐ ┌─────────────────────────┐        │
│  │  资源负荷柱状图          │ │  部门对比图              │        │
│  │                         │ │                         │        │
│  └─────────────────────────┘ └─────────────────────────┘        │
├─────────────────────────────────────────────────────────────────────┤
│  数据表格区域                                                         │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  [Tab]: [项目排行] [任务统计] [资源使用]                  │    │
│  ├─────────────────────────────────────────────────────────┤    │
│  │  数据表格                                                │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 页面2：详细报表页

```
┌─────────────────────────────────────────────────────────────────────┐
│  面包屑导航                                                          │
│  [报表统计] > [项目进度报表]                                         │
├─────────────────────────────────────────────────────────────────────┤
│  报表标题和筛选                                                      │
│  [报表名称] [时间范围] [导出PDF] [导出Excel]                         │
├─────────────────────────────────────────────────────────────────────┤
│  报表内容区域                                                         │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  报表标题                                                   │   │
│  │  报表时间：2026年1月1日 - 2026年1月31日                      │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │  报表摘要                                                   │   │
│  │  - 统计指标概览                                            │   │
│  │  - 主要发现                                                 │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │  详细数据表格                                               │   │
│  │  ┌─────────────────────────────────────────────────────┐   │   │
│  │  │ 数据表格内容                                         │   │   │
│  │  └─────────────────────────────────────────────────────┘   │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │  图表展示                                                   │   │
│  │  ┌───────────────┐ ┌───────────────┐                      │   │
│  │  │ 图表1         │ │ 图表2         │                      │   │
│  │  └───────────────┘ └───────────────┘                      │   │
│  └─────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 统计指标设计

### 3.1 核心统计指标

| 指标名称 | 计算方式 | 数据类型 | 单位 |
|----------|----------|----------|------|
| 项目总数 | 统计所有项目 | 整数 | 个 |
| 进行中项目数 | 状态=进行中的项目 | 整数 | 个 |
| 已完成项目数 | 状态=已完成的项目 | 整数 | 个 |
| 逾期项目数 | 当前日期>结束日期且未完成 | 整数 | 个 |
| 项目完成率 | 已完成/总数*100 | 百分比 | % |
| 任务总数 | 统计所有任务 | 整数 | 个 |
| 完成任务数 | 状态=已完成的任务 | 整数 | 个 |
| 任务完成率 | 完成任务/总数*100 | 百分比 | % |
| 平均项目进度 | 所有项目进度平均值 | 百分比 | % |
| 预算使用率 | 已使用预算/总预算*100 | 百分比 | % |
| 资源利用率 | 已分配工时/可用工时*100 | 百分比 | % |
| 逾期任务数 | 当前日期>截止日期且未完成 | 整数 | 个 |

### 3.2 统计卡片布局

| 卡片数量 | 排列方式 | 卡片宽度 |
|----------|----------|----------|
| 5个 | 5列等宽 | 20% |
| 4个 | 4列等宽 | 25% |
| 3个 | 3列等宽 | 33% |

---

## 4. 图表设计

### 4.1 图表类型

#### 4.1.1 饼图/环形图

**用途**：项目状态分布、任务状态分布

| 图表名称 | 数据维度 | 交互功能 |
|----------|----------|----------|
| 项目状态分布 | 规划中、进行中、已暂停、已完成、已归档 | 鼠标悬停显示数值和占比 |
| 任务状态分布 | 待办、进行中、已完成、已取消 | 点击跳转到对应列表 |
| 预算使用分布 | 已使用、剩余、超支 | 图例筛选 |

#### 4.1.2 折线图

**用途**：进度趋势、任务完成趋势

| 图表名称 | X轴 | Y轴 | 交互功能 |
|----------|-----|-----|----------|
| 项目进度趋势 | 时间（日/周/月） | 进度百分比 | 鼠标悬停显示详细数据 |
| 任务完成趋势 | 时间 | 完成任务数量 | 区域缩放 |
| 资源负荷趋势 | 时间 | 资源使用率 | 数据点标记 |

#### 4.1.3 柱状图

**用途**：部门对比、项目对比、成员绩效

| 图表名称 | X轴 | Y轴 | 交互功能 |
|----------|-----|-----|----------|
| 部门项目数 | 部门名称 | 项目数量 | 按数值排序 |
| 部门完成率 | 部门名称 | 完成百分比 | 悬停显示详情 |
| 项目进度对比 | 项目名称 | 进度百分比 | 点击跳转项目 |
| 成员任务完成排行 | 成员姓名 | 完成任务数 | 悬停显示详情 |

#### 4.1.4 条形图

**用途**：任务分布、资源分配

| 图表名称 | 用途 |
|----------|------|
| 任务优先级分布 | 按优先级展示任务数量 |
| 资源分配情况 | 展示成员资源分配占比 |

#### 4.1.5 仪表盘

**用途**：关键指标监控

| 图表名称 | 刻度范围 | 指标说明 |
|----------|----------|----------|
| 项目健康度 | 0-100 | 综合评估项目健康状况 |
| 进度达成率 | 0-100 | 对比计划进度和实际进度 |
| 资源负荷 | 0-150% | 资源使用负荷百分比 |

### 4.2 图表交互规范

| 交互类型 | 触发方式 | 响应行为 |
|----------|----------|----------|
| 悬停提示 | 鼠标悬停 | 显示数据点详细信息 |
| 点击选择 | 单击数据点 | 选中并高亮显示 |
| 图例筛选 | 点击图例 | 显示/隐藏对应数据系列 |
| 缩放 | 滚轮/拖拽 | 时间轴缩放 |
| 重置 | 双击 | 恢复到默认视图 |

### 4.3 图表配色方案

| 数据系列 | 颜色值 | 用途说明 |
|----------|--------|----------|
| 系列1 | #1E5EB8 | 主数据系列 |
| 系列2 | #52C41A | 成功/完成 |
| 系列3 | #FAAD14 | 警告/进行中 |
| 系列4 | #FF4D4F | 危险/逾期 |
| 系列5 | #8C8C8C | 灰色/其他 |

---

## 5. 报表类型设计

### 5.1 报表类型清单

| 报表名称 | 报表类型 | 更新频率 | 主要受众 |
|----------|----------|----------|----------|
| 项目进度日报 | 日报 | 每日更新 | 项目经理 |
| 项目进度周报 | 周报 | 每周更新 | 项目经理、部门经理 |
| 项目进度月报 | 月报 | 每月更新 | 部门经理、高层 |
| 资源使用报表 | 月报 | 每月更新 | 部门经理 |
| 任务完成报表 | 周报 | 每周更新 | 项目经理 |
| 部门绩效报表 | 月报 | 每月更新 | 高层管理者 |
| 项目成本报表 | 月报 | 每月更新 | 财务、高层 |
| 逾期项目报表 | 实时 | 实时更新 | 项目经理、高层 |

### 5.2 项目进度周报表结构

#### 5.2.1 报表封面信息

| 字段 | 内容 |
|------|------|
| 报表名称 | 项目进度周报 |
| 报表周期 | 2026年1月6日 - 2026年1月12日 |
| 生成时间 | 2026-01-12 18:00 |
| 报表负责人 | 系统自动生成 |

#### 5.2.2 报表摘要

| 统计项 | 本周数据 | 环比变化 |
|--------|----------|----------|
| 在进行项目数 | 12个 | +2 |
| 本周完成任务数 | 25个 | +8 |
| 新增项目数 | 2个 | +1 |
| 逾期项目数 | 3个 | -1 |
| 平均项目进度 | 65% | +5% |

#### 5.2.3 详细数据表格

| 列名 | 说明 |
|------|------|
| 项目名称 | 项目标识和名称 |
| 项目经理 | 负责人姓名 |
| 计划进度 | 计划完成进度 |
| 实际进度 | 实际完成进度 |
| 进度偏差 | 实际-计划 |
| 任务完成率 | 本周任务完成比例 |
| 风险问题 | 主要风险或问题 |
| 下周计划 | 下周主要工作计划 |

### 5.3 资源使用月报表结构

#### 5.3.1 资源概览

| 统计项 | 数据 |
|--------|------|
| 部门总人数 | 50人 |
| 项目参与人数 | 35人 |
| 平均资源利用率 | 78% |
| 资源闲置率 | 22% |
| 资源超负荷人数 | 5人 |

#### 5.3.2 成员资源使用表

| 列名 | 说明 |
|------|------|
| 成员姓名 | 员工姓名 |
| 所属部门 | 部门名称 |
| 参与项目数 | 分配的项目数量 |
| 计划工时 | 本月计划工时 |
| 实际工时 | 本月实际工时 |
| 利用率 | 实际/计划*100 |
| 负荷状态 | 正常/偏高/偏低 |

---

## 6. 交互设计

### 6.1 页面加载流程

```
进入页面 → 显示骨架屏 → 加载统计数据 → 加载图表数据 → 加载表格数据 → 完成
```

### 6.2 筛选交互

1. 用户在筛选控制栏选择筛选条件
2. 点击"应用"按钮或自动触发
3. 显示加载状态
4. 刷新所有统计数据、图表和表格

### 6.3 图表交互

1. **鼠标悬停**：显示数据点详细信息（数值、时间、占比等）
2. **点击数据点**：弹出详情面板或跳转到对应列表
3. **图例点击**：切换对应数据系列的显示/隐藏
4. **时间轴缩放**：鼠标滚轮缩放或拖拽选择范围

### 6.4 报表导出交互

1. 点击"导出报表"按钮
2. 选择导出格式（PDF/Excel/CSV）
3. 选择报表时间范围和数据范围
4. 点击"生成报表"
5. 显示导出进度
6. 导出完成后自动下载或提供下载链接

---

## 7. 数据接口设计

### 7.1 API接口列表

| 接口名称 | 请求方式 | 路径 | 说明 |
|----------|----------|------|------|
| 获取统计数据 | GET | /api/v1/reports/stats | 获取核心统计指标 |
| 获取图表数据 | GET | /api/v1/reports/charts/{type} | 获取图表数据 |
| 获取表格数据 | GET | /api/v1/reports/tables/{type} | 获取表格数据 |
| 获取项目排行 | GET | /api/v1/reports/project-rank | 获取项目排行榜 |
| 获取任务统计 | GET | /api/v1/reports/task-stats | 获取任务统计 |
| 获取资源使用 | GET | /api/v1/reports/resource-usage | 获取资源使用情况 |
| 获取部门统计 | GET | /api/v1/reports/department-stats | 获取部门统计数据 |
| 导出报表 | GET | /api/v1/reports/export | 导出报表文件 |
| 获取报表模板 | GET | /api/v1/reports/templates | 获取报表模板列表 |
| 生成报表 | POST | /api/v1/reports/generate | 生成自定义报表 |

### 7.2 数据字段说明

#### 统计数据字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| project_total | number | 项目总数 |
| project_active | number | 进行中项目数 |
| project_completed | number | 已完成项目数 |
| project_overdue | number | 逾期项目数 |
| task_total | number | 任务总数 |
| task_completed | number | 完成任务数 |
| task_overdue | number | 逾期任务数 |
| avg_progress | number | 平均进度 |
| budget_usage | number | 预算使用率 |
| resource_usage | number | 资源利用率 |

#### 图表数据字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| chart_type | string | 图表类型 |
| title | string | 图表标题 |
| x_axis | array | X轴数据 |
| series | array | 数据系列 |
| legend | array | 图例数据 |
| tooltip | object | 提示框配置 |

#### 表格数据字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| table_type | string | 表格类型 |
| headers | array | 表头数组 |
| rows | array | 数据行数组 |
| total | number | 数据总条数 |
| page | number | 当前页码 |
| page_size | number | 每页数量 |

---

## 8. 组件设计

### 8.1 组件结构

```
ReportsIndex.vue (报表统计首页)
├── PageHeader
├── FilterControlBar (筛选控制栏)
│   ├── DateRangePicker
│   ├── ProjectSelector
│   ├── DepartmentSelector
│   └── DataTypeSelector
├── StatisticsCards (统计卡片)
│   └── StatCard
├── ChartGrid (图表网格)
│   ├── PieChart (饼图)
│   ├── LineChart (折线图)
│   ├── BarChart (柱状图)
│   └── GaugeChart (仪表盘)
├── DataTabs (数据Tab)
│   ├── ProjectRankTable (项目排行)
│   ├── TaskStatsTable (任务统计)
│   └── ResourceUsageTable (资源使用)
└── ExportButton (导出按钮)

ReportDetail.vue (详细报表页)
├── BreadcrumbNav (面包屑导航)
├── ReportHeader (报表头部)
│   ├── ReportTitle
│   ├── DateRange
│   └── ExportButtons
├── ReportSummary (报表摘要)
├── ReportChart (报表图表)
├── ReportTable (报表表格)
└── Pagination (分页)
```

### 8.2 核心组件说明

#### StatisticsCards 组件

- **功能**：展示核心统计指标卡片
- **特性**：
  - 支持数值和趋势箭头显示
  - 支持环比对比
  - 支持点击跳转详情
- **属性**：
  - `statsData`：统计数据对象
  - `loading`：加载状态

#### ChartGrid 组件

- **功能**：展示多个图表的网格布局
- **特性**：
  - 响应式网格布局
  - 图表间自适应高度
  - 支持拖拽调整布局
- **子组件**：
  - PieChart：饼图
  - LineChart：折线图
  - BarChart：柱状图
  - GaugeChart：仪表盘

#### DataTabs 组件

- **功能**：切换不同数据视图
- **Tab页签**：
  - 项目排行
  - 任务统计
  - 资源使用

---

## 9. 样式设计

### 9.1 页面整体样式

```scss
.reports-page {
  max-width: 1440px;
  margin: 0 auto;
  padding: 24px;
  
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
  }
  
  .filter-control-bar {
    display: flex;
    gap: 16px;
    margin-bottom: 24px;
    padding: 16px;
    background: #fff;
    border-radius: 8px;
    flex-wrap: wrap;
  }
  
  .statistics-cards {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 16px;
    margin-bottom: 24px;
  }
  
  .chart-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
    margin-bottom: 24px;
  }
  
  .data-tabs {
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
  }
}

.report-detail-page {
  padding: 24px;
  
  .breadcrumb-nav {
    margin-bottom: 16px;
  }
  
  .report-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    padding: 16px;
    background: #fff;
    border-radius: 8px;
  }
  
  .report-summary {
    margin-bottom: 24px;
    padding: 16px;
    background: #fff;
    border-radius: 8px;
  }
  
  .report-charts {
    margin-bottom: 24px;
  }
  
  .report-table {
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
  }
}
```

### 9.2 统计卡片样式

```scss
.stat-card {
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  
  .stat-icon {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 12px;
  }
  
  .stat-value {
    font-size: 28px;
    font-weight: 600;
    color: #262626;
    line-height: 1.2;
  }
  
  .stat-label {
    font-size: 14px;
    color: #595959;
    margin-top: 4px;
  }
  
  .stat-trend {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-top: 8px;
    font-size: 12px;
    
    &.up {
      color: #52C41A;
    }
    
    &.down {
      color: #FF4D4F;
    }
  }
}
```

### 9.3 图表容器样式

```scss
.chart-container {
  background: #fff;
  border-radius: 8px;
  padding: 20px;
  
  .chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }
  
  .chart-title {
    font-size: 16px;
    font-weight: 600;
    color: #262626;
  }
  
  .chart-body {
    height: 280px;
  }
}
```

---

## 10. 导出功能设计

### 10.1 导出格式

| 格式 | 适用场景 | 特点 |
|------|----------|------|
| PDF | 正式报告、打印 | 版式固定、支持分页 |
| Excel | 数据分析、二次处理 | 支持多Sheet、数据完整 |
| CSV | 数据导入、系统对接 | 通用格式、文件小 |

### 10.2 导出配置项

| 配置项 | 类型 | 说明 |
|--------|------|------|
| 时间范围 | 日期区间 | 报表数据的时间范围 |
| 项目范围 | 多选 | 选择要导出的项目 |
| 部门范围 | 多选 | 选择要导出的部门 |
| 数据类型 | 多选 | 选择要包含的数据类型 |
| 图表导出 | 开关 | 是否包含图表图片 |
| 报表格式 | 单选 | PDF/Excel/CSV |

### 10.3 导出文件命名规范

```
{报表类型}_{项目名称/全部}_{起始日期}_{结束日期}.{格式}

示例：
项目进度周报_项目A_20260106_20260112.pdf
任务统计月报_全部_20260101_20260131.xlsx
```

---

## 11. 无障碍性设计

### 11.1 键盘导航

| 快捷键 | 功能 |
|--------|------|
| Ctrl+E | 打开导出面板 |
| Ctrl+R | 刷新报表数据 |
| Tab | 切换焦点元素 |
| Enter | 确认选择 |

### 11.2 ARIA属性

```vue
<!-- 统计卡片 -->
<article role="figure" aria-label="项目总数统计">
  <span role="heading" aria-level="2">项目总数</span>
  <span aria-valuenow="25" role="meter">25</span>
</article>

<!-- 图表 -->
<figure role="img" aria-label="项目进度分布饼图">
  <figcaption>项目进度分布</figcaption>
</figure>

<!-- 数据表格 -->
<table role="grid" aria-label="项目排行数据">
  <thead>...</thead>
  <tbody>...</tbody>
</table>
```

### 11.3 屏幕阅读器支持

- 统计数值配合变化趋势说明
- 图表提供数据摘要文本
- 表格提供行列数说明

---

## 12. 测试用例

### 12.1 功能测试

| 测试场景 | 预期结果 |
|----------|----------|
| 进入报表统计页面 | 正确显示统计卡片和图表 |
| 切换筛选条件 | 统计数据正确更新 |
| 悬停图表数据点 | 显示详细数据信息 |
| 点击图例 | 正确显示/隐藏数据系列 |
| 点击数据Tab | 正确切换数据表格 |
| 导出报表（PDF） | 正确生成PDF文件 |
| 导出报表（Excel） | 正确生成Excel文件 |
| 大数据量时性能 | 页面响应流畅 |

### 12.2 边界测试

| 测试场景 | 预期结果 |
|----------|----------|
| 无数据时展示 | 显示空状态提示 |
| 单个项目筛选 | 正确显示单个项目数据 |
| 全年数据范围 | 图表正确显示全年趋势 |
| 并发请求 | 数据加载正常 |

---

## 13. 验收标准

### 13.1 功能验收

- [ ] 统计卡片数据准确
- [ ] 图表展示正确
- [ ] 筛选功能正常
- [ ] Tab切换正常
- [ ] 导出功能正常
- [ ] 响应式布局正常

### 13.2 性能验收

- [ ] 页面加载时间 < 3秒
- [ ] 图表渲染时间 < 1秒
- [ ] 导出时间 < 10秒（1000条数据）

### 13.3 无障碍验收

- [ ] 键盘导航完整
- [ ] ARIA属性正确
- [ ] 屏幕阅读器兼容

---

## 14. 开发计划

### 14.1 开发顺序

1. 页面基础布局和样式
2. 统计卡片组件
3. 图表组件集成
4. 筛选控制栏
5. 数据表格Tab
6. 导出功能
7. API联调
8. 性能优化
9. 测试验收

### 14.2 预计工时

| 任务 | 预计工时 |
|------|----------|
| 基础布局和样式 | 2小时 |
| 统计卡片组件 | 2小时 |
| 图表组件集成 | 6小时 |
| 筛选控制栏 | 2小时 |
| 数据表格Tab | 3小时 |
| 导出功能 | 4小时 |
| API联调 | 4小时 |
| 性能优化 | 2小时 |
| 测试验收 | 3小时 |
| **总计** | **28小时** |

---

## 15. 后续迭代

### 15.1 功能增强

- 自定义报表模板
- 定时报表自动生成
- 报表订阅推送
- 数据钻取分析
- 预测分析

### 15.2 可视化增强

- 3D图表
- 交互式地图
- 实时数据流
- AR/VR可视化

---

**文档版本**: v1.0  
**最后更新**: 2026-02-10

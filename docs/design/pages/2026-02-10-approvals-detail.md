# 审批详情页 - 设计文档

**版本**: v1.0
**创建日期**: 2026-02-10
**更新日期**: 2026-02-10
**状态**: 待实现

---

## 一、页面概述

### 1.1 页面定位

审批详情页提供审批任务的详细信息查看和操作功能，支持查看审批详情、查看审批历史、审批任务分配、审批记录查询等。

### 1.2 用户角色

- **审批人**: 拥有审批权限，可进行审批操作
- **申请人**: 查看申请详情和审批结果
- **其他用户**: 仅查看权限

### 1.3 页面路径

```
/projects/:id/approvals/:approvalId
```

### 1.4 权限控制

| 功能 | 审批人 | 申请人 | 其他用户 |
|------|--------|--------|----------|
| 查看详情 | ✅ | ✅ | ✅ |
| 查看历史 | ✅ | ✅ | ✅ |
| 审批操作 | ✅ | ❌ | ❌ |
| 分配审批 | ✅ | ❌ | ❌ |
| 查看统计 | ✅ | ❌ | ❌ |

---

## 二、页面布局

### 2.1 整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│  [← 返回]  审批详情                                 [⋮更多 v]      │
├─────────────────────────────────────────────────────────────────┤
│  审批标题: 系统架构设计方案变更审批                              │
│  审批Key: APPROVE-123456                                      │
├─────────────────────────────────────────────────────────────────┤
│  [📋 基本信息]  [👥 申请人]  [📜 审批历史]  [📝 申请内容]       │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ Tab 内容区                                                  │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  面包屑: 首页 / 项目 / 审批管理 / 审批详情                       │
└─────────────────────────────────────────────────────────────────┘
```

---

## 三、Tab 导航设计

### 3.1 Tab 列表

| Tab | 图标 | 说明 |
|-----|------|------|
| 基本信息 | 📋 | 审批基本信息 |
| 申请人 | 👥 | 申请人信息 |
| 审批历史 | 📜 | 审批记录 |
| 申请内容 | 📝 | 完整申请内容 |

---

## 四、基本信息 Tab

### 4.1 审批卡片

```
┌─────────────────────────────────────────────────────────────────┐
│  📋 基本信息                                    [💾 保存修改]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  审批标题                                     │
│  [系统架构设计方案变更审批]                                  │
│                                                                 │
│  审批Key (只读)                                               │
│  [APPROVE-123456____________________________] (只读)            │
│                                                                 │
│  审批类型                                     │
│  [变更审批 v]                                            │
│  - 新增审批                                            │
│  - 变更审批                                             │
│  - 撤销审批                                             │
│                                                                 │
│  审批状态                                     │
│  [⏸️ 待审批 v]                                        │
│  - ⏸️ 待审批 (pending)                                  │
│  - ✅ 已通过 (approved)                                  │
│  - ❌ 已拒绝 (rejected)                                  │
│  - 🔄 处理中 (in_progress)                                │
│                                                                 │
│  审批流程                                     │
│  [审批流程 v]                                            │
│  - 流程1: 技术负责人 (待审批)                                 │
│  - 流程2: 项目经理 (待审批)                                  │
│  - 流程3: 财务负责人 (待审批)                                 │
│                                                                 │
│  审批人                                             │
│  [未指定 v]                                          │
│  - 未指定 (待分配)                                       │
│  - 张三 (技术负责人)                                       │
│  - 李四 (项目经理)                                         │
│  - 王五 (财务负责人)                                        │
│                                                                 │
│  审批截止日期                                           │
│  [📅 2026-02-28 ____________]                                 │
│  (可选，默认30天)                                            │
│                                                                 │
│  优先级                                             │
│  [🔴 紧急 v]                                          │
│  - 🔴 紧急                                             │
│  - 🟠 高                                              │
│  - 🔵 中                                              │
│  - ⚪ 低                                              │
│                                                                 │
│  关联项目                                       │
│  [企业项目管理系统 v]                                   │
│  - 企业项目管理系统 (PJ123456)                              │
│                                                                 │
│  描述                                             │
│  [_______________________________________]                    │
│  [_______________________________________]                    │
│  (可选，最多500字符)                                          │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                          [取消]  [保存修改]                      │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 状态说明

| 状态 | 值 | 颜色 | 说明 |
|------|------|------|------|
| 待审批 | pending | 灰色 | 等待审批人处理 |
| 处理中 | in_progress | 蓝色 | 审批人正在处理 |
| 已通过 | approved | 绿色 | 审批已通过 |
| 已拒绝 | rejected | 红色 | 审批已拒绝 |
| 已撤销 | cancelled | 黄色 | 审批已撤销 |

---

## 五、申请人 Tab

### 5.1 申请人信息

```
┌─────────────────────────────────────────────────────────────────┐
│  👥 申请人                                    [编辑] [发送消息] │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 👤 张三 (项目负责人)                                      │ │
│  │                                                           │ │
│  │ 📧 zhangsan@example.com                                   │ │
│  │ 📱 +86 138 0000 0000                                      │ │
│  │ 💼 研发部 - 高级工程师                                    │ │
│  │ 🎯 技能: Vue, Python, FastAPI, SQL                         │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  申请人状态                                                     │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 状态: 在线 ✓                                               │ │
│  │ 角色: 项目经理                                             │ │
│  │ 在线时间: 最近5分钟                                        │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  联系方式                                                       │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 📞 电话: 138-0000-0000                                     │ │
│  │ 📧 邮箱: zhangsan@example.com                              │ │
│  │ 📱 微信: zhangsan_wx                                        │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  负责项目                                                     │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ - 企业项目管理系统 (项目负责人)                            │ │
│  │ - 企业内部管理系统 (团队成员)                               │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  历史审批记录                                                   │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 审批1: 系统架构设计 (2026-01-15) - ✅ 通过                  │ │
│  │ 审批2: 系统数据库设计 (2026-01-20) - ✅ 通过                │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 六、审批历史 Tab

### 6.1 审批流程图

```
┌─────────────────────────────────────────────────────────────────┐
│  📜 审批历史                                [导出日志]           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 申请人: 张三                                               │ │
│  │ 审批标题: 系统架构设计方案变更审批                           │ │
│  │ 提交时间: 2026-02-10 10:30                                  │ │
│  │ 当前状态: ⏸️ 待审批                                         │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 1. 流程节点: 技术负责人                                     │ │
│  │    节点状态: ⏸️ 待审批                                      │ │
│  │    审批人: 未指定                                           │ │
│  │    提交时间: 2026-02-10 10:30                               │ │
│  │    截止时间: 2026-02-12 23:59                               │ │
│  │    备注:                                                   │ │
│  │    当前步骤: 1/3                                           │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 2. 流程节点: 项目经理                                       │ │
│  │    节点状态: ⏸️ 待审批                                      │ │
│  │    审批人: 未指定                                           │ │
│  │    提交时间: -                                             │ │
│  │    截止时间: 2026-02-15 23:59                               │ │
│  │    备注:                                                   │ │
│  │    当前步骤: 2/3                                           │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 3. 流程节点: 财务负责人                                     │ │
│  │    节点状态: ⏸️ 待审批                                      │ │
│  │    审批人: 未指定                                           │ │
│  │    提交时间: -                                             │ │
│  │    截止时间: 2026-02-20 23:59                               │ │
│  │    备注:                                                   │ │
│  │    当前步骤: 3/3                                           │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  📊 流程统计                                                   │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 总流程: 3个节点                                            │ │
│  │ 已完成: 0个                                                │ │
│  │ 进行中: 0个                                                │ │
│  │ 待处理: 3个                                                │ │
│  │ 总耗时: 0天                                                │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 审批记录详情

```
┌─────────────────────────────────────────────────────────────────┐
│  📝 审批记录详情                                [关闭]            │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 申请人: 张三                                               │ │
│  │ 审批标题: 系统架构设计方案变更审批                           │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  审批记录                                                     │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 2026-02-10 10:30: 审批申请提交                               │ │
│  │    申请人: 张三                                             │ │
│  │    申请原因: 需要将系统架构从单体改为微服务架构               │ │
│  │    关联任务: TASK-12345, TASK-12346                         │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 2026-02-10 10:35: 技术负责人分配                             │ │
│  │    审批人: 李四                                             │ │
│  │    分配原因: 需要技术负责人审核架构变更                      │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 2026-02-10 14:20: 审批操作                                  │ │
│  │    审批人: 李四                                             │ │
│  │    审批操作: ✅ 同意                                         │ │
│  │    审批意见: 架构变更合理，同意实施                         │ │
│  │    审批时间: 2026-02-10 14:20                               │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 2026-02-10 14:25: 流程流转                                   │ │
│  │    从: 技术负责人                                           │ │
│  │    到: 项目经理                                           │ │
│  │    备注: 审批通过，流转到下一节点                           │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 七、申请内容 Tab

### 7.1 申请内容展示

```
┌─────────────────────────────────────────────────────────────────┐
│  📝 申请内容                                        [导出PDF]      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  审批类型: 变更审批                                              │
│  关联任务: TASK-12345                                           │
│  项目Key: PJ123456                                              │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 申请标题: 系统架构设计方案变更                               │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 1. 变更原因                                                 │ │
│  │                                                            │ │
│  │ 由于系统用户量增长到10万+，原单体架构无法支撑               │ │
│  │ 需要拆分为微服务架构，提高系统扩展性和可维护性               │ │
│  │                                                            │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 2. 变更方案                                                 │ │
│  │                                                            │ │
│  │ [详细变更方案...                                          │ │
│  │                                                            │ │
│  │ 2.1 用户服务 (user-service)                               │ │
│  │   - 负责用户注册、登录、权限管理                            │ │
│  │   - 单独部署，水平扩展                                     │ │
│  │                                                            │ │
│  │ 2.2 认证服务 (auth-service)                                │ │
│  │   - 负责JWT令牌生成和验证                                  │ │
│  │   - 单独部署，水平扩展                                     │ │
│  │                                                            │ │
│  │ 2.3 项目服务 (project-service)                             │ │
│  │   - 负责项目管理和任务管理                                  │ │
│  │   - 单独部署，水平扩展                                     │ │
│  │                                                            │ │
│  │ ...                                                        │ │
│  │                                                            │ │
│  │ 详细方案文档: 架构变更方案.pdf                              │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 3. 影响评估                                                 │ │
│  │                                                            │ │
│  │ 3.1 技术影响                                                │ │
│  │    - 需要重构现有代码                                       │ │
│  │    - 需要新增服务间通信                                    │ │
│  │    - 需要调整数据库架构                                    │ │
│  │                                                            │ │
│  │ 3.2 时间影响                                                │ │
│  │    - 预计需要2周开发时间                                    │ │
│  │    - 需要额外测试1周                                        │ │
│  │    - 总计: 3周                                              │ │
│  │                                                            │ │
│  │ 3.3 风险评估                                                │ │
│  │    - 中等风险: 架构重构可能导致临时性能下降                 │ │
│  │    - 低风险: 需要额外的测试工作量                          │ │
│  │                                                            │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 4. 关联文件                                                 │ │
│  │                                                            │ │
│  │ 📄 架构变更方案.pdf (2.5MB)                                 │ │
│  │ 📄 数据库变更.sql (150KB)                                   │ │
│  │ 📄 测试计划.md (5KB)                                        │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ 5. 签名确认                                                 │ │
│  │                                                            │ │
│  │ 申请人签名: 张三 _________________ (2026-02-10)            │ │
│  │                                                            │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 八、审批操作

### 8.1 审批操作按钮

```
┌─────────────────────────────────────────────────────────────────┐
│  审批操作                                                       │
│                                                                 │
│  [✅ 同意]                                                       │
│  [❌ 拒绝]                                                       │
│  [⏸️ 暂停]                                                       │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.2 同意操作

```
┌─────────────────────────────────────────────┐
│  同意审批                               [X] │
├─────────────────────────────────────────────┤
│  请填写同意意见:                                     │
│  [_______________________________________]    │
│  (可选，最多500字符)                               │
│                                                                 │
│  审批后操作:                                               │
│  ☑ 自动流转到下一节点                                     │
│  ☐ 通知申请人                                             │
│  ☐ 添加审批记录到项目日志                                 │
│                                                                 │
├─────────────────────────────────────────────┤
│                          [取消]  [同意]      │
└─────────────────────────────────────────────┘
```

### 8.3 拒绝操作

```
┌─────────────────────────────────────────────┐
│  拒绝审批                               [X] │
├─────────────────────────────────────────────┤
│  请填写拒绝原因:                                     │
│  [_______________________________________]    │
│  (必填，最多500字符)                               │
│                                                                 │
│  拒绝后操作:                                               │
│  ☐ 关闭审批流程                                           │
│  ☑ 通知申请人                                             │
│  ☐ 返回申请内容                                           │
│                                                                 │
├─────────────────────────────────────────────┤
│                          [取消]  [拒绝]      │
└─────────────────────────────────────────────┘
```

---

## 九、API 接口

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/v1/approvals/{id} | 获取审批详情 |
| PUT | /api/v1/approvals/{id} | 更新审批信息 |
| POST | /api/v1/approvals/{id}/approve | 审批同意 |
| POST | /api/v1/approvals/{id}/reject | 审批拒绝 |
| POST | /api/v1/approvals/{id}/assign | 分配审批人 |
| GET | /api/v1/approvals/{id}/history | 获取审批历史 |
| GET | /api/v1/approvals/{id}/content | 获取申请内容 |
| DELETE | /api/v1/approvals/{id} | 删除审批 |

---

## 十、设计原则

### 10.1 清晰性

- 审批状态一目了然
- 审批流程清晰展示
- 操作指引明确

### 10.2 一致性

- 使用统一的审批流程设计
- 统一的审批操作界面
- 统一的状态标识

### 10.3 安全性

- 审批操作需要二次确认
- 审批记录完整可追溯
- 权限严格控制

### 10.4 便捷性

- 支持快捷审批操作
- 支持批量审批
- 支持审批模板

---

## 十一、注意事项

### 11.1 流程控制

- 审批必须按顺序流转
- 未到节点的操作不可用
- 已完成的节点不可修改

### 11.2 权限控制

- 只有当前节点的审批人可以操作
- 其他节点信息只读
- 非审批人只能查看详情

### 11.3 通知机制

- 审批完成后自动通知申请人
- 审批过程中通知相关人员
- 重要审批支持发送邮件

---

**文档结束**

**创建人**: 设计团队
**创建日期**: 2026-02-10
**版本**: v1.0
